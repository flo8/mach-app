---
title: マップ
description: キーを知っていれば、マップを使ってアイテムを簡単に検索できます。マップにはキーと値の概念があります。
lastmod: 2023-05-26T02:58:15.374Z
---

# マップの使用方法

マップは、キーと値の形式で物事を格納することができる複雑なデータ構造です。これにより、電話帳や翻訳辞書などのシナリオを実装することができます。

## 導入

この章では以下の内容をカバーします：

- マップの定義。
- キーによるマップの値の読み取りと、イテレーション。
- マップの内容の変更。

## マップの使用例

コーディングする際に、検索が必要なものがある場合があります。たとえば、辞書を使用すると、英語からスペイン語への単語の翻訳方法を調べることができます。プログラミングでも同様の状況があります。たとえば、特定のポートで実行されているサービスを知りたい場合などです。また、一意のキーが特定の値を指すという概念に基づいているデータベースもあります。

これらすべては、マップ構造を使用して実装されます。アイデアは、キーと値を定義し、それらをグループ化すること、つまりマップに収集することです。

## マップの作成

Goでマップを作成するには、次の構文を使用する必要があります：

```go
map[<キーの型>]<値の型>{ ... エントリ }
```

以下は、電話帳を保持できるマップ構造を作成する例です：

```go
phonebook := map[int]string{ 555123: "Robin Hood", 555404: "Sheriff of Nottingham"}
```

キーの型を`int`、値の型を`string`としてマップ構造を定義します。その後、`{}`で値を割り当てます。各エントリは`<キー>: <値>`の形式で定義され、コンマで区切られます。では、値を読み取るにはどうすればよいでしょうか？

### `make()`を使用したマップの作成

マップを作成する別の方法として、`make()`関数を使用する方法があります。`make()`に型を指定して呼び出すと、初期化されたマップが返されます。

```go
dictionaryEnSv = make(map[string]string)
```

### エントリの追加

マップにエントリを追加するには、キーと値のエントリを指定する必要があります。

```go
dictionaryEnSv["hello"] = "hej"
```

## キーによる値の読み取り

今、これらの2つのエントリがあるとしましょう。エントリ555404の値を取得したい場合、どのようにすればよいでしょうか？ `[]`を使用します。

```go
phonebook[555404] // "Sheriff of Nottingham"
```

### 存在するエントリの確認

`phonebook[555404]`が値を返すことを学びました。では、存在しない場合はどうなるでしょうか？ マップに格納されていないキーを指定すると、結果として何も返されません。

```go
phonebook[888] // これはコンソール上では空として表示されます
```

キーでエントリにアクセスすると、値と真偽値の2つの値が返されます。真偽値は、このキーがマップに存在するかどうかを示します。次のコードをご覧ください。

```go
_, exist := phonebook[888]
fmt.Println(exist) // false
```

ここでは値が返されますが、この一度だけの機会に無視することを選択し、`exist`に焦点を当てるための真偽値です。

この構文をif文で使用することもできます。

```go
if _, exist := phonebook[888] {
  // 番号が存在するので、その人に電話をかける
}
```

## マップのイテレーション

`for`構文と`range`を使用してマップをイテレートすることができます。以下はイテレーションの方法です。

```go
for key, value := range phonebook {
  fmt.Println(key, value)
}
```

## エントリの削除

マップからエントリを削除するには、`delete()`メソッドを使用します。`delete()`メソッドは、マップと削除するキーをパラメータとして受け取ります。

```go
delete(phonebook, 555404)
```

## 課題 - 電話帳の作成

以下があなたの連絡先です：

```
Alice 555-123
Bob 555-124
Jean 555-125
```

```console
電話帳へようこそ。
コマンド> store
連絡先を入力してください：Rob 555-126
連絡先が保存されました。
コマンド> list
Alice 555-123
Bob 555-124
Jean 555-125
Rob 555-126
コマンド> lookup
名前を入力してください：Alice
Aliceの番号は555-123です。
```

ヒント：マップとスライスの両方を使用する必要があるかもしれません。

## 解答例

```go
package main

import "fmt"

func main() {
 var command string
 contacts := make(map[string]string)
 fmt.Println("電話帳へようこそ")

 for {
  fmt.Print("コマンド> ")
  fmt.Scan(&command)
  if command == "store" {
   fmt.Print("連絡先を入力してください：")
   var contact string
   var no string
   fmt.Scan(&contact, &no)
   contacts[contact] = no
   fmt.Println("連絡先が保存されました")
  } else if command == "list" {
   for key, value := range contacts {
    fmt.Println(key, value)
   }
  } else if command == "lookup" {
   fmt.Print("名前を入力してください：")
   var contact string
   fmt.Scan(&contact)
   fmt.Println(contacts[contact])
  } else if command == "quit" {
   break
  } else {
   fmt.Println("不明なコマンド：", command)
  }
 }
 fmt.Println("さようなら")
}

```

## チャレンジ

現在、エラーチェックがありません。存在しない連絡先を検索した場合にエラーメッセージが表示されるようにチェックを追加してください。以下はその動作例です。

```console
コマンド> lookup
名前を入力してください：Jane
連絡先が存在しません。追加しますか？ y/n: y
連絡先を入力してください：Jane 123
連絡先が保存されました。
```