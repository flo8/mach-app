---
import MainLayout from '@layouts/MainLayout.astro';
import OnboardingWidget from '@components/Auth/Onboarding.vue';
import { locales } from '@constants/localize';
const {
  pages: { onboarding: localPage }
} = locales;
const pageData = {
  title: localPage.title,
  description: localPage.description
};
---

<MainLayout {...pageData}>
  <OnboardingWidget siteName={import.meta.env.PUBLIC_SITE_NAME || process.env.PUBLIC_SITE_NAME} client:only='vue' />
</MainLayout>

<script>
  import { getUser } from '@stores/auth';
  const BASE_URL = import.meta.env.BASE_URL;
  const user = await getUser();
  const hasName = typeof user?.user_metadata?.full_name === 'string';
  if (!user || !!(user?.user_metadata?.updated_at && hasName)) {
    const route = !!user ? 'profile/' : '';
    window.location.assign(`${BASE_URL}${route}`);
  }
</script>
